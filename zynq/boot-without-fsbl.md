Zynq boot without Vivado
========================

Here how we can separate as much as possible the FPGA design (via proprietary Vivado tool)
and OS/BPS (kernel, bootloader).

Prologue
--------
- The SoC _can_ boot without any bitstream
- The SoC ROM can always access SDcard and will search for BOOT.bit file on 1st FAT partition
- The BOOT.bit in the official Xilinx workflow contains
  1) the FSBL (first stage bootloader)
  2) uBoot
  3) FPGA bitstream

- the FSBL
  1) configures/enables the DDR controller
  2) setup the pads (MIO/EMIO..)
  3) load the bitstream onto the FPGA
  4) is generated by the Xilinx EDK and packaged with the Xilinx BSP (Board support package)

Getting rid of FSBL
-------------------
We have an alternative to the FSBL: recent u-boot ships with a so-called *SPL* (Secondary Program Loader)

The SPL:
    - can run without DDR
    - will configure the DDR controller
    - will configure PADS
    - will access the SD in order to fetch actual u-boot and run it!

We don't need anymore the Xilinx EDK. The system can be booted *almost* without any Xilinx stuff.

The FPGA can be either
    - programmed by u-boot
    - programmed after-boot from Linux

However, configuration for the DDR controller (board dependant!) and for PADS must be
supplied to the SPL.

Actually we need two files (ps7_init_gpl.[ch]) from Vivado to be put into the u-boot source tree.

u-boot comes with generic files that configures DDR and place some "default" PAD init

Since PAD configuration depends by our system design we probably still need to replace these files with those generated by Vivado, however maybe it could be possible to enable u-boot to fetch a config file from the SD (so we don't need to recompile anything) or reconfigure thigs after boot (but for now we cannot yet).

Booting with the SPL
--------------------

- configure u-boot (*make ARCH=arm CROSS-COMPILE=arm-none-eabi- zynq-zturn-defconfig*)
- make u-boot (*make ARCH=arm CROSS-COMPILE=arm-none-eabi-*)
- copy spl/boot.bin onto the SD (warning, you could have actually *BOOT*.bit instead..)
- copy u-boot.img onto the SD (warning, don't know why, I had to rename it it *u-boot-dtb.img*
- copy u-boot.dtb onto the SD.